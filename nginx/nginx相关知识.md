## 1. 反向代理

反向代理说起来也很简单，比如你拨打一个电话号码，对方问你要找谁，然后帮你转接到对应的人的分机上。每个人拨打的都是相同的号码，但也都会通过转接找到对应的人，如果有人拨打错了，也会有友好的提示。

你没有直接拨打对应人的号码，而是拨打了统一转接人的电话，这个人所做的事情就是反向代理, 反向代理是他会把你的问题转述给对应的人，并且把对应人的回答再转述给你。

反向代理对服务器的要求很高，```nginx```是这方面的专家，所以大部分我们的服务器都使用```nginx```作为入口服务器，起到传达人的作用。

举例来说一个```web```请求走进服务首先会经过```nginx```，然后由```nginx```转发到对应的应用服务器。比如你想访问一张图片，你首先进入到```nginx```，```nginx```通过你想要的图片路径到对应的图片服务器拿到这张图片，再返回给你。

为什么会有反向代理呢？因为我们的应用服务由于要求开发效率非常的高，所以他的运行效率是很低的，他的```qbs```，```tps```并发都是受限的，在处理业务的同时很难兼容处理用户的请求。

一般这种情况我们会搭建很多台服务，组成一个集群，向用户提供高可用性。正是因为很多服务构成集群的时候，这么多台服务暴露的地址不同，才需要```nginx```具有反向代理的功能，可以把请求传导给应用服务。而用户面临的只是```nginx```一台服务的地址。

对于用户的请求收口在```nginx```层也可以提高网站的安全性和便宜性。假设我们想要修改接口的响应头，只需要修改```nginx```就可以了，而不需要每台服务都去修改，想要停止服务访问，也只需要关掉```nginx```, 不需要每台服务都去关闭。

## 2. 正向代理

上面举了个打电话的例子讲解反向代理，其实反向代理代理的是服务器，客户端不知道实际提供服务的服务器，也就是打电话的人每次电话打给的都是那个电话转接人。

正向代理是假设春节你想买一张火车票，你找了黄牛，黄牛帮你买到了票，很多人都找这个黄牛，黄牛帮很多人买了票，这个黄牛就是正向代理，对于服务来说每次买票的都是黄牛。服务不知道真正买票的人是谁。正向代理时服务端不知道真正发起请求的客户端。

换句话说，反向代理要求代理服务器和提供服务的服务器在同一个网络中，正向代理要求客户端和代理服务器在同一个网络中。

## 3. 负载均衡

负载均衡是用来解决大流量问题，因为每台服务器可承受的访问量是有限的，随着公司的发展访问量会越来越大，这个时候我们会选择通过增加服务器的方式来平衡每台服务器所受的压力。

前面也说了我们的应用服务因为要求开发效率非常的高，所以他的运行效率是很低的，他的```qbs```，```tps```并发都是受限的，所以我们需要把很多这样的应用服务组成一个集群，向用户提供高可用性。

而每一次```web```请求进来，```nginx```都可以选择一台压力较少的服务器，然后将请求发送给这台服务进行处理。这就是负载均衡。

在服务领域一旦很多应用服务构成集群，他一定会带来两个需求，第一个需求我们需要动态的扩容，我们在增加一台服务器的时候，不可能关闭网站，让网站停止使用，他一定是一个无感知的过程，这就是动态扩容```nginx```是支持的。也就是你可以不关闭的情况下增加一台服务。

第二个则是有些服务出问题的时候我们需要做容灾，假设我们的服务器集群中一台服务器出现了问题，是不应该影响用户访问的，```nginx```会把请求发送给其它正常的服务器保证线上用户的正常使用。

## 4. 静态资源缓存

在一个链路中，```nginx```是处在企业内网的一个边缘节点，也就是网站的最外层，所有的请求和访问都是由```nginx```做转发，这样随着我们网络链路的增长，用户体验到的时延会增加。

所以如果我们能把一些所有用户看起来不变的，或者在一段时间内看起来不变的动态内容缓存在```nginx```中，由```nginx```直接向用户提供访问，那这样用户的时延就会减少很多。

所以反向代理会衍生出另外一个功能叫缓存，他能够加速我们的访问，而很多时候我们在访问像```css```或者```js```文件，或者这样一些小图片，那么这样静态的资源是没有必要由应用服务来访问的，他只需要通过本地文件，系统上放置的静态资源，直接由```nginx```提供访问就可以。这是```ngi