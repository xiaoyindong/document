## 1. 概述

所谓性能优化就是为了让网站运行的更快，我们可以让加载的文件加载的更快也就是获取文件更快，第二个是文件获取之后代码文件执行更快。

加载更快我们有很多的策略，比如说浏览器的缓存，文件打包压缩，```webpack```相应的代码优化等。因为有了前端编译的功能，所以前端性能优化可做的事情越来越多。很多性能优化的事情可以在编译层做。

我们经常会遇到这样一个问题，从输入```url```到页面加载完成做了哪些事情，我们的性能优化就是从这样一个切入点开始讲解。这里面涉及到的每一步都有性能优化的空间。

1.用户输入```taobao.com```

2.浏览器通过```DNS```，把```url```解析为```ip```

3.浏览器和```ip```地址建立```tcp```链接，发送```http```请求

4.服务器接收请求后进行查库，读文件等，拼接好返回的```http```相应数据。

5.浏览器收到首屏```html```，开始渲染。

6.解析```html```中的```dom```

7.解析```css```

8.```dom + css```生成```render-tree```绘图

9.加载```script```的```js```文件

10.执行```js```脚本。

所谓性能优化，就是上面的步骤加在一起的时间尽可能的短，所以基本也就两大方向。一个是少加载文件，另个一个少执行代码。

## 2. DNS缓存

我们首先来说```DNS```，他的全程是```domain name service```就是专门把域名转换为```ip```的这样一个服务，其实```DNS```也像是网络的一个协议。

我们对于```DNS```的性能优化是```DNS```的预解析，就是我们在```html```中可以先设置一些```DNS```的解析路径，因为```DNS```并不是一次就可以拿到内容的，他是一个递归查询，一级一级查找到的。

```DNS```预解析就是在```html```中声明一些```link```标签，在项目中如果涉及到其他域名的资源可以在加载过程中同时去处理```DNS```，这样在我们发起请求的时候```DNS```已经在本地缓存中了。

```html
<link rel="dns-prefetch" href="//q.alicdn.com" />
<link rel="dns-prefetch" href="//img.alicdn.com" />
```

## 3. TCP

```TCP```是很重要的一个协议，```http```就是在```TCP```的基础上构建的，```TCP```理解也很简单，他就像是浏览器和服务器的聊天过程，这个过程也是我们性能优化的主要途径。

在代码层面我们的性能优化成效微乎其微，但是在网络层面的优化收益却是巨大的。

```http```是一种```tcp/ip```协议，```ip```是网址域名通过```DNS```解析后拿到的地址，可以理解为要请求的服务器位置，```tcp```负责数据的完整性和有序性。

优化策略也很简单:

1.建立长连接

2.减少文件体积

比如文件压缩，```gzip```传输等

3.减少文件请求次数

雪碧图，```js```和```css```打包，缓存控制，懒加载

4.减少用户和服务器的距离, ```cdn```使用

5.本地存储。

```http```会携带无用的数据，比如```header```和```cookie```，应该合理利用缓存机制解决这些问题。

## 4. 浏览器缓